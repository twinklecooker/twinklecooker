// === onepiece_adventure_bot/index.js === const { Client, GatewayIntentBits, Collection } = require('discord.js'); const fs = require('fs'); const path = require('path'); const client = new Client({ intents: [GatewayIntentBits.Guilds, GatewayIntentBits.GuildMessages, GatewayIntentBits.MessageContent] });

// Collections pour les commandes et les données joueurs client.commands = new Collection(); const joueurs = new Map(); // mémoire temporaire, on ajoutera la persistance plus tard

// === RACES DE BASE === const races = ['Humain', 'Homme-Poisson', 'Géant', 'Mink', 'Skypiean', 'Lunarian'];

// === LISTE DES ÎLES === const iles = [ 'East Blue', 'Shells Town', 'Orange Town', 'Baratie', 'Arlong Park', 'Loguetown', 'Reverse Mountain', 'Whiskey Peak', 'Little Garden', 'Drum Island', 'Alabasta', 'Jaya', 'Skypiea', 'Water 7', 'Enies Lobby', 'Thriller Bark', 'Sabaody', 'Amazon Lily', 'Impel Down', 'Marineford', 'Punk Hazard', 'Dressrosa', 'Zou', 'Whole Cake Island', 'Wano', 'Elbaf' ];

// === COMMANDE !start === client.on('messageCreate', async message => { if (message.content.startsWith('!start')) { if (joueurs.has(message.author.id)) { return message.reply('Tu as déjà commencé ton aventure !'); }

// Choisir race aléatoire pour l'instant
    const race = races[Math.floor(Math.random() * races.length)];

    const joueur = {
        nom: message.author.username,
        ile: 0,
        niveau: 1,
        xp: 0,
        vie: 100,
        race,
        haki: {
            armement: { actif: false, niveau: 0 },
            observation: { actif: false, niveau: 0 },
            rois: { actif: false, niveau: 0 }
        },
        fruit: null,
        arme: null,
        style: 'Mêlée'
    };

    joueurs.set(message.author.id, joueur);
    message.reply(`Bienvenue dans l'aventure One Piece, ${joueur.nom} ! Tu es un ${joueur.race} et tu commences à ${iles[0]}`);
}

});

// === COMMANDE !stats === client.on('messageCreate', message => { if (message.content === '!stats') { const joueur = joueurs.get(message.author.id); if (!joueur) return message.reply("Tu n'as pas encore commencé. Tape !start.");

message.reply(`**Stats de ${joueur.nom}**\nRace: ${joueur.race}\nNiveau: ${joueur.niveau}\nXP: ${joueur.xp}\nÎle: ${iles[joueur.ile]}\nFruit: ${joueur.fruit || 'Aucun'}\nArme: ${joueur.arme || 'Mains'}\nStyle: ${joueur.style}`);
}

});

// === COMMANDE !island === client.on('messageCreate', message => { if (message.content === '!island') { const joueur = joueurs.get(message.author.id); if (!joueur) return message.reply("Tu n'as pas encore commencé. Tape !start.");

message.reply(`Tu es actuellement à **${iles[joueur.ile]}**.`);
}

});

// === COMMANDE !explore === client.on('messageCreate', message => { if (message.content === '!explore') { const joueur = joueurs.get(message.author.id); if (!joueur) return message.reply("Tu n'as pas encore commencé. Tape !start.");

const events = ['mob', 'boss', 'rien'];
    const event = events[Math.floor(Math.random() * events.length)];

    if (event === 'mob') {
        message.reply(`Tu rencontres un pirate ! Tape \`!fight\` pour combattre.`);
    } else if (event === 'boss') {
        message.reply(`Un boss bloque le chemin sur ${iles[joueur.ile]} ! Tape \`!fight\` pour l'affronter.`);
    } else {
        message.reply("Tu explores mais il ne se passe rien pour l’instant...");
    }
}

});

client.login('TON_TOKEN_ICI');

